# å¿«é€Ÿå¼€å§‹æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåƒç´ é£åŒäººè”æœº RPG æ¸¸æˆçš„æµ‹è¯•ä¸ä¼˜åŒ–æ¡†æ¶ï¼Œæ—¨åœ¨ç¡®ä¿æ¸¸æˆçš„æ€§èƒ½ã€å¹³è¡¡æ€§å’Œç”¨æˆ·ä½“éªŒè¾¾åˆ°æœ€ä½³çŠ¶æ€ã€‚

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- .NET SDK 6.0+ æˆ– Unity 2021.3+
- Git

### 2. è¿è¡Œæµ‹è¯•

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/DARK20050101/game.git
cd game

# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
dotnet run --project Tests/Tests.csproj
```

### 3. æŸ¥çœ‹æµ‹è¯•ç»“æœ

æµ‹è¯•è¿è¡Œåä¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š

- âœ“ ç½‘ç»œå‹åŠ›æµ‹è¯•ç»“æœ
- âœ“ æ¸¸æˆå¹³è¡¡æ€§è¯„ä¼°
- âœ“ ç”¨æˆ·ä½“éªŒè¯„åˆ†

## ä¸»è¦åŠŸèƒ½

### ğŸŒ è”æœºå‹åŠ›æµ‹è¯•

**ç›®æ ‡**: æ¨¡æ‹Ÿ 200 äººå¹¶å‘ï¼Œå»¶è¿Ÿ â‰¤200msï¼Œé‡è¿ç‡ â‰¥95%

```bash
# è¿è¡Œç½‘ç»œå‹åŠ›æµ‹è¯•
dotnet test --filter "Category=StressTest"
```

**æµ‹è¯•å†…å®¹**:
- 200 å®¢æˆ·ç«¯å¹¶å‘è¿æ¥
- ç½‘ç»œå»¶è¿Ÿæµ‹é‡
- æ–­çº¿é‡è¿æ¨¡æ‹Ÿ

### âš–ï¸ å¹³è¡¡æ€§æµ‹è¯•

**ç›®æ ‡**: ç¡®ä¿æ¸¸æˆæœºåˆ¶å…¬å¹³åˆç†

```bash
# è¿è¡Œå¹³è¡¡æ€§æµ‹è¯•
dotnet test --filter "Category=BalanceTest"
```

**æµ‹è¯•å†…å®¹**:
- å‰¯æœ¬éš¾åº¦åˆ†å¸ƒ
- æ‰è½ç‡éªŒè¯ï¼ˆåŒäºº = å•äºº Ã— 1.5ï¼‰
- åä½œ Buff è§¦å‘ï¼ˆè·ç¦» â‰¤5 æ ¼ï¼‰
- ç»„é˜Ÿå¥–åŠ±è®¡ç®—ï¼ˆç»éªŒ +25%ï¼‰

### ğŸ® ä½“éªŒä¼˜åŒ–æµ‹è¯•

**ç›®æ ‡**: ç®€åŒ–æ“ä½œæµç¨‹ï¼Œæå‡å“åº”é€Ÿåº¦

```bash
# è¿è¡Œä½“éªŒæµ‹è¯•
dotnet test --filter "Category=ExperienceTest"
```

**æµ‹è¯•å†…å®¹**:
- æ“ä½œæµç¨‹æ­¥éª¤ç»Ÿè®¡
- ä¸€é”®é‚€è¯·åŠŸèƒ½éªŒè¯
- UI å“åº”æ—¶é—´æµ‹é‡

## æ ¸å¿ƒç³»ç»Ÿ

### 1. ä¼˜åŒ–çš„ç½‘ç»œç®¡ç†å™¨

ä½ç½®: `Scripts/Network/OptimizedNetworkManager.cs`

**ç‰¹æ€§**:
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- å¿ƒè·³æ£€æµ‹
- UDP/TCP æ··åˆä¼ è¾“
- æ•°æ®å‹ç¼©

```csharp
var networkManager = new OptimizedNetworkManager();
await networkManager.Connect("127.0.0.1:7777");
```

### 2. ä¸€é”®é‚€è¯·ç³»ç»Ÿ

ä½ç½®: `Scripts/Player/QuickInviteSystem.cs`

**ç‰¹æ€§**:
- ä¸€é”®å‘é€é‚€è¯·
- ä¸€é”®æ¥å—é‚€è¯·
- æ™ºèƒ½ç©å®¶æ¨è
- å¥½å‹åˆ—è¡¨å¿«é€Ÿè®¿é—®

```csharp
var inviteSystem = new QuickInviteSystem();
await inviteSystem.QuickInvite(friendId);
await inviteSystem.QuickAccept(invitationId);
```

### 3. åä½œ Buff ç³»ç»Ÿ

ä½ç½®: `Scripts/Game/CooperationBuffSystem.cs`

**ç‰¹æ€§**:
- è·ç¦»æ£€æµ‹ï¼ˆâ‰¤5 æ ¼è§¦å‘ï¼‰
- å¤šç§ Buff åŠ æˆ
- å®æ—¶çŠ¶æ€æ›´æ–°

```csharp
var buffSystem = new CooperationBuffSystem();
buffSystem.UpdatePlayerPosition(playerId, x, y, z);
bool hasBuff = buffSystem.HasCooperationBuff(playerId);
```

## é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½ç½®: `Config/game_config.json`

### ä¿®æ”¹é…ç½®

```json
{
  "network": {
    "maxConcurrentUsers": 200,
    "targetLatencyMs": 200
  },
  "balance": {
    "duoDropMultiplier": 1.5,
    "duoExpBonus": 0.25
  },
  "experience": {
    "enableQuickInvite": true
  }
}
```

## æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      æœ€ç»ˆæµ‹è¯•æŠ¥å‘Š                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è¯¦ç»†æµ‹è¯•ç»“æœ:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. ç½‘ç»œå‹åŠ›æµ‹è¯•: âœ“ é€šè¿‡
   - è¿æ¥æˆåŠŸç‡: 98.50%
   - å¹³å‡å»¶è¿Ÿ: 165ms
   - é‡è¿æˆåŠŸç‡: 97.00%

2. å¹³è¡¡æ€§æµ‹è¯•: âœ“ é€šè¿‡
   - æ‰è½ç‡æ¯”ä¾‹: 1.48x
   - Buffæµ‹è¯•é€šè¿‡ç‡: 100.00%
   - ç»„é˜Ÿç»éªŒåŠ æˆ: +25.0%

3. ç”¨æˆ·ä½“éªŒæµ‹è¯•: âœ“ é€šè¿‡
   - ç»¼åˆè¯„åˆ†: 95.00%
   - æµç¨‹æ•ˆç‡: 100.00%
   - é‚€è¯·ç³»ç»Ÿ: 100.00%

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»ä½“æµ‹è¯•ç»“æœ: âœ“âœ“âœ“ å…¨éƒ¨é€šè¿‡ âœ“âœ“âœ“
```

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•

1. åœ¨ç›¸åº”æµ‹è¯•ç›®å½•åˆ›å»ºæµ‹è¯•ç±»
2. ç»§æ‰¿åŸºç¡€æµ‹è¯•ç±»
3. å®ç°æµ‹è¯•é€»è¾‘
4. åœ¨ `TestRunner.cs` ä¸­æ³¨å†Œ

```csharp
// ç¤ºä¾‹ï¼šæ·»åŠ æ–°çš„å¹³è¡¡æµ‹è¯•
public class CustomBalanceTest
{
    public void TestCustomMechanic()
    {
        // æµ‹è¯•é€»è¾‘
    }
}
```

### è°ƒæ•´å¹³è¡¡å‚æ•°

ç¼–è¾‘ `Config/game_config.json`:

```json
{
  "balance": {
    "baseDropRate": 0.15,        // æé«˜åŸºç¡€æ‰è½ç‡
    "cooperationBuffDistance": 7  // å¢åŠ  Buff è§¦å‘è·ç¦»
  }
}
```

### ä¼˜åŒ–ç½‘ç»œæ€§èƒ½

ç¼–è¾‘ `Scripts/Network/OptimizedNetworkManager.cs`:

```csharp
// è°ƒæ•´å¿ƒè·³é—´éš”
private const int HEARTBEAT_INTERVAL_MS = 3000; // ä» 5000 é™è‡³ 3000

// è°ƒæ•´è¶…æ—¶æ—¶é—´
private const int CONNECTION_TIMEOUT_MS = 8000; // ä» 10000 é™è‡³ 8000
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æé«˜é‡è¿æˆåŠŸç‡ï¼Ÿ

A: åœ¨ `OptimizedNetworkManager.cs` ä¸­å¢åŠ é‡è¿å°è¯•æ¬¡æ•°ï¼š

```csharp
private const int MAX_RECONNECT_ATTEMPTS = 10; // ä» 5 å¢åŠ åˆ° 10
```

### Q: å¦‚ä½•è°ƒæ•´æ‰è½ç‡ï¼Ÿ

A: ä¿®æ”¹ `Config/game_config.json` ä¸­çš„ `baseDropRate` å’Œ `duoDropMultiplier`ã€‚

### Q: å¦‚ä½•æµ‹è¯•å•ä¸ªç³»ç»Ÿï¼Ÿ

A: ç›´æ¥å®ä¾‹åŒ–å¹¶è¿è¡Œå¯¹åº”çš„æµ‹è¯•ç±»ï¼Œæˆ–ä½¿ç”¨.NETæµ‹è¯•è¿‡æ»¤å™¨ï¼š

```csharp
// æ–¹å¼1: åˆ›å»ºç®€å•çš„æµ‹è¯•ç¨‹åº
var stressTest = new NetworkStressTest();
var result = await stressTest.RunStressTest();

// æ–¹å¼2: ä½¿ç”¨dotnet testï¼ˆéœ€è¦é…ç½®æµ‹è¯•é¡¹ç›®ï¼‰
dotnet test Tests/Tests.csproj --filter "Category=StressTest"
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç½‘ç»œä¼˜åŒ–

1. **ä½¿ç”¨ UDP è¿›è¡Œä½ç½®åŒæ­¥** - é™ä½å»¶è¿Ÿ
2. **å¯ç”¨æ•°æ®å‹ç¼©** - å‡å°‘å¸¦å®½å ç”¨
3. **å®ç°å®¢æˆ·ç«¯é¢„æµ‹** - æ”¹å–„å»¶è¿Ÿæ„ŸçŸ¥
4. **è¿æ¥æ± ç®¡ç†** - æé«˜å¹¶å‘èƒ½åŠ›

### å¹³è¡¡ä¼˜åŒ–

1. **å®šæœŸæ”¶é›†æ•°æ®** - åŸºäºå®é™…æ¸¸æˆæ•°æ®è°ƒæ•´
2. **A/B æµ‹è¯•** - å¯¹æ¯”ä¸åŒå‚æ•°æ•ˆæœ
3. **ç©å®¶åé¦ˆ** - æ ¹æ®ç¤¾åŒºåé¦ˆå¾®è°ƒ

### ä½“éªŒä¼˜åŒ–

1. **å‡å°‘æ“ä½œæ­¥éª¤** - æ¯ä¸ªæµç¨‹ â‰¤3 æ­¥
2. **å¿«é€Ÿå“åº”** - UI å“åº”æ—¶é—´ <200ms
3. **æ¸…æ™°åé¦ˆ** - æ¯ä¸ªæ“ä½œéƒ½æœ‰è§†è§‰åé¦ˆ
4. **æ™ºèƒ½æ¨è** - ä½¿ç”¨æœºå™¨å­¦ä¹ ä¼˜åŒ–æ¨è

## ä¸‹ä¸€æ­¥

1. **é›†æˆåˆ° Unity** - å°†è„šæœ¬å¯¼å…¥ Unity é¡¹ç›®
2. **å®é™…æµ‹è¯•** - åœ¨çœŸå®ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•
3. **æ•°æ®æ”¶é›†** - æ”¶é›†çœŸå®ç©å®¶æ•°æ®
4. **è¿­ä»£ä¼˜åŒ–** - æ ¹æ®æ•°æ®æŒç»­ä¼˜åŒ–

## æ–‡æ¡£é“¾æ¥

- [è¯¦ç»†æ–‡æ¡£](Documentation/TESTING_OPTIMIZATION.md)
- [é…ç½®è¯´æ˜](Config/game_config.json)
- [API æ–‡æ¡£](Documentation/API.md)

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## æˆæƒ

MIT License

---

**ç¥ä½ æ¸¸æˆå¼€å‘é¡ºåˆ©ï¼** ğŸ®âœ¨
